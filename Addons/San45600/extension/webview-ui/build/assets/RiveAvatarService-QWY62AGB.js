import{v as On}from"./chunk-RFZYAZFR.js";import{c as xn}from"./index.js";var on={exports:{}};(function(N,pe){(function(Pe,K){N.exports=K()})(xn,()=>(()=>{var We=[,(B,z,V)=>{V.r(z),V.d(z,{default:()=>Ue});var ve=(()=>{var ie=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(O={}){var c=O,le,Ae;c.ready=new Promise((t,e)=>{le=t,Ae=e});function oe(){function t(f){const l=i;r=e=0,i=new Map,l.forEach(p=>{try{p(f)}catch(h){console.error(h)}}),this.Qa(),s&&s.nb()}let e=0,r=0,i=new Map,s=null,u=null;this.requestAnimationFrame=function(f){e||(e=requestAnimationFrame(t.bind(this)));const l=++r;return i.set(l,f),l},this.cancelAnimationFrame=function(f){i.delete(f),e&&i.size==0&&(cancelAnimationFrame(e),e=0)},this.lb=function(f){u&&(document.body.remove(u),u=null),f||(u=document.createElement("div"),u.style.backgroundColor="black",u.style.position="fixed",u.style.right=0,u.style.top=0,u.style.color="white",u.style.padding="4px",u.innerHTML="RIVE FPS",f=function(l){u.innerHTML="RIVE FPS "+l.toFixed(1)},document.body.appendChild(u)),s=new function(){let l=0,p=0;this.nb=function(){var h=performance.now();p?(++l,h-=p,1e3<h&&(f(1e3*l/h),l=p=0)):(p=h,l=0)}}},this.ib=function(){u&&(document.body.remove(u),u=null),s=null},this.Qa=function(){}}function me(t){console.assert(!0);const e=new Map;let r=-1/0;this.push=function(i){return i=i+((1<<t)-1)>>t,e.has(i)&&clearTimeout(e.get(i)),e.set(i,setTimeout(function(){e.delete(i),e.length==0?r=-1/0:i==r&&(r=Math.max(...e.keys()),console.assert(r<i))},1e3)),r=Math.max(i,r),r<<t}}const fe=new function(){function t(){if(!e){let k=function(Q,_,S){if(_=b.createShader(_),b.shaderSource(_,S),b.compileShader(_),S=b.getShaderInfoLog(_),0<S.length)throw S;b.attachShader(Q,_)};var R=document.createElement("canvas"),C={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,preferLowPowerToHighPerformance:0,failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let b=R.getContext("webgl2",C);if(b)r=2;else if(b=R.getContext("webgl",C))r=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(i=Math.min(b.getParameter(b.MAX_RENDERBUFFER_SIZE),b.getParameter(b.MAX_TEXTURE_SIZE)),R=b.createProgram(),k(R,b.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),k(R,b.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),b.bindAttribLocation(R,0,"vertex"),b.bindAttribLocation(R,1,"uv"),b.linkProgram(R),C=b.getProgramInfoLog(R),0<C.trim().length)throw C;s=b.getUniformLocation(R,"mat"),u=b.getUniformLocation(R,"translate"),b.useProgram(R),b.bindBuffer(b.ARRAY_BUFFER,b.createBuffer()),b.enableVertexAttribArray(0),b.enableVertexAttribArray(1),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,b.createBuffer()),b.uniform1i(b.getUniformLocation(R,"image"),0),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e=b}return!0}let e=null,r=0,i=0,s=null,u=null,f=0,l=0;this.wb=function(){return t(),i},this.gb=function(R){if(!t())return null;const C=e.createTexture();return e.bindTexture(e.TEXTURE_2D,C),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,R),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),r==2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),C};const p=new me(8),h=new me(8),y=new me(10),T=new me(10);this.kb=function(R,C,b,k,Q){if(t()){var _=p.push(R),S=h.push(C);(e.canvas.width!=_||e.canvas.height!=S)&&(e.canvas.width=_,e.canvas.height=S),e.viewport(0,S-C,R,C),e.disable(e.SCISSOR_TEST),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.SCISSOR_TEST),b.sort((I,Xe)=>Xe.Ua-I.Ua),_=y.push(k),f!=_&&(e.bufferData(e.ARRAY_BUFFER,8*_,e.DYNAMIC_DRAW),f=_),_=0;for(var q of b)e.bufferSubData(e.ARRAY_BUFFER,_,q.Da),_+=4*q.Da.length;console.assert(_==4*k);for(var ce of b)e.bufferSubData(e.ARRAY_BUFFER,_,ce.Xa),_+=4*ce.Xa.length;console.assert(_==8*k),_=T.push(Q),l!=_&&(e.bufferData(e.ELEMENT_ARRAY_BUFFER,2*_,e.DYNAMIC_DRAW),l=_),q=0;for(var Se of b)e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,q,Se.indices),q+=2*Se.indices.length;console.assert(q==2*Q),Se=0,ce=!0,_=q=0;for(const I of b){I.image.za!=Se&&(e.bindTexture(e.TEXTURE_2D,I.image.cb||null),Se=I.image.za),I.zb?(e.scissor(I.Ia,S-I.Ja-I.Pa,I.Gb,I.Pa),ce=!0):ce&&(e.scissor(0,S-C,R,C),ce=!1),b=2/R;const Xe=-2/C;e.uniform4f(s,I.oa[0]*b*I.va,I.oa[1]*Xe*I.wa,I.oa[2]*b*I.va,I.oa[3]*Xe*I.wa),e.uniform2f(u,I.oa[4]*b*I.va+b*(I.Ia-I.xb*I.va)-1,I.oa[5]*Xe*I.wa+Xe*(I.Ja-I.yb*I.wa)+1),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,_),e.vertexAttribPointer(1,2,e.FLOAT,!1,0,_+4*k),e.drawElements(e.TRIANGLES,I.indices.length,e.UNSIGNED_SHORT,q),_+=4*I.Da.length,q+=2*I.indices.length}console.assert(_==4*k),console.assert(q==2*Q)}},this.canvas=function(){return t()&&e.canvas}};c.onRuntimeInitialized=function(){function t(m){switch(m){case h.srcOver:return"source-over";case h.screen:return"screen";case h.overlay:return"overlay";case h.darken:return"darken";case h.lighten:return"lighten";case h.colorDodge:return"color-dodge";case h.colorBurn:return"color-burn";case h.hardLight:return"hard-light";case h.softLight:return"soft-light";case h.difference:return"difference";case h.exclusion:return"exclusion";case h.multiply:return"multiply";case h.hue:return"hue";case h.saturation:return"saturation";case h.color:return"color";case h.luminosity:return"luminosity"}}function e(m){return"rgba("+((16711680&m)>>>16)+","+((65280&m)>>>8)+","+((255&m)>>>0)+","+((4278190080&m)>>>24)/255+")"}function r(){0<q.length&&(fe.kb(S.drawWidth(),S.drawHeight(),q,ce,Se),q=[],Se=ce=0,S.reset(512,512));for(const m of _){for(const E of m.da)E();m.da=[]}_.clear()}var i=c.RenderPaintStyle;const s=c.RenderPath,u=c.RenderPaint,f=c.Renderer,l=c.StrokeCap,p=c.StrokeJoin,h=c.BlendMode,y=i.fill,T=i.stroke,R=c.FillRule.evenOdd;let C=1;var b=c.RenderImage.extend("CanvasRenderImage",{__construct:function(){this.__parent.__construct.call(this),this.za=C,C=C+1&2147483647||1},decode:function(m){let E=Lt;E.total++;var j=this,X=new Image;X.src=URL.createObjectURL(new Blob([m],{type:"image/png"})),X.onload=function(){if(j.ab=X,j.cb=fe.gb(X),j.size(X.width,X.height),E.loaded++,E.loaded===E.total){const D=E.ready;D&&(D(),E.ready=null)}}}}),k=s.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.ia=new Path2D},rewind:function(){this.ia=new Path2D},addPath:function(m,E,j,X,D,H,F){var $=this.ia,de=$.addPath;m=m.ia;const J=new DOMMatrix;J.a=E,J.b=j,J.c=X,J.d=D,J.e=H,J.f=F,de.call($,m,J)},fillRule:function(m){this.Ga=m},moveTo:function(m,E){this.ia.moveTo(m,E)},lineTo:function(m,E){this.ia.lineTo(m,E)},cubicTo:function(m,E,j,X,D,H){this.ia.bezierCurveTo(m,E,j,X,D,H)},close:function(){this.ia.closePath()}}),Q=u.extend("CanvasRenderPaint",{color:function(m){this.Ha=e(m)},thickness:function(m){this.eb=m},join:function(m){switch(m){case p.miter:this.ya="miter";break;case p.round:this.ya="round";break;case p.bevel:this.ya="bevel"}},cap:function(m){switch(m){case l.butt:this.xa="butt";break;case l.round:this.xa="round";break;case l.square:this.xa="square"}},style:function(m){this.bb=m},blendMode:function(m){this.$a=t(m)},clearGradient:function(){this.qa=null},linearGradient:function(m,E,j,X){this.qa={Va:m,Wa:E,La:j,Ma:X,Ca:[]}},radialGradient:function(m,E,j,X){this.qa={Va:m,Wa:E,La:j,Ma:X,Ca:[],ub:!0}},addStop:function(m,E){this.qa.Ca.push({color:m,stop:E})},completeGradient:function(){},draw:function(m,E,j){let X=this.bb;var D=this.Ha,H=this.qa;if(m.globalCompositeOperation=this.$a,H!=null){D=H.Va;var F=H.Wa;const de=H.La;var $=H.Ma;const J=H.Ca;H.ub?(H=de-D,$-=F,D=m.createRadialGradient(D,F,0,D,F,Math.sqrt(H*H+$*$))):D=m.createLinearGradient(D,F,de,$);for(let Re=0,ee=J.length;Re<ee;Re++)F=J[Re],D.addColorStop(F.stop,e(F.color));this.Ha=D,this.qa=null}switch(X){case T:m.strokeStyle=D,m.lineWidth=this.eb,m.lineCap=this.xa,m.lineJoin=this.ya,m.stroke(E);break;case y:m.fillStyle=D,m.fill(E,j)}}});const _=new Set;let S=null,q=[],ce=0,Se=0;var I=c.CanvasRenderer=f.extend("Renderer",{__construct:function(m){this.__parent.__construct.call(this),this.ha=[1,0,0,1,0,0],this.ba=m.getContext("2d"),this.Fa=m,this.da=[]},save:function(){this.ha.push(...this.ha.slice(this.ha.length-6)),this.da.push(this.ba.save.bind(this.ba))},restore:function(){const m=this.ha.length-6;if(6>m)throw"restore() called without matching save().";this.ha.splice(m),this.da.push(this.ba.restore.bind(this.ba))},transform:function(m,E,j,X,D,H){const F=this.ha,$=F.length-6;F.splice($,6,F[$]*m+F[$+2]*E,F[$+1]*m+F[$+3]*E,F[$]*j+F[$+2]*X,F[$+1]*j+F[$+3]*X,F[$]*D+F[$+2]*H+F[$+4],F[$+1]*D+F[$+3]*H+F[$+5]),this.da.push(this.ba.transform.bind(this.ba,m,E,j,X,D,H))},rotate:function(m){const E=Math.sin(m);m=Math.cos(m),this.transform(m,E,-E,m,0,0)},_drawPath:function(m,E){this.da.push(E.draw.bind(E,this.ba,m.ia,m.Ga===R?"evenodd":"nonzero"))},drawImage:function(m,...E){var j=this.ba;this.da.push(function(){j.drawImage(m,...E)})},_drawRiveImage:function(m,E,j){var X=m.ab;if(X){var D=this.ba,H=t(E);this.da.push(function(){D.globalCompositeOperation=H,D.globalAlpha=j,D.drawImage(X,0,0),D.globalAlpha=1})}},_getMatrix:function(m){const E=this.ha,j=E.length-6;for(let X=0;6>X;++X)m[X]=E[j+X]},_drawImageMesh:function(m,E,j,X,D,H,F,$,de,J){var Re=this.ba.canvas.width,ee=this.ba.canvas.height;const tn=de-F,nn=J-$;F=Math.max(F,0),$=Math.max($,0),de=Math.min(de,Re),J=Math.min(J,ee);const et=de-F,tt=J-$;if(console.assert(et<=Math.min(tn,Re)),console.assert(tt<=Math.min(nn,ee)),!(0>=et||0>=tt)){de=et<tn||tt<nn,Re=J=1;var De=Math.ceil(et*J),ke=Math.ceil(tt*Re);ee=fe.wb(),De>ee&&(J*=ee/De,De=ee),ke>ee&&(Re*=ee/ke,ke=ee),S||(S=new c.DynamicRectanizer(ee),S.reset(512,512)),ee=S.addRect(De,ke),0>ee&&(r(),_.add(this),ee=S.addRect(De,ke),console.assert(0<=ee));var rn=ee&65535,an=ee>>16;q.push({oa:this.ha.slice(this.ha.length-6),image:m,Ia:rn,Ja:an,xb:F,yb:$,Gb:De,Pa:ke,va:J,wa:Re,Da:new Float32Array(X),Xa:new Float32Array(D),indices:new Uint16Array(H),zb:de,Ua:m.za<<1|(de?1:0)}),ce+=X.length,Se+=H.length;var He=this.ba,Wn=t(E);this.da.push(function(){He.save(),He.resetTransform(),He.globalCompositeOperation=Wn,He.globalAlpha=j,He.drawImage(fe.canvas(),rn,an,De,ke,F,$,et,tt),He.restore()})}},_clipPath:function(m){this.da.push(this.ba.clip.bind(this.ba,m.ia,m.Ga===R?"evenodd":"nonzero"))},clear:function(){_.add(this),this.da.push(this.ba.clearRect.bind(this.ba,0,0,this.Fa.width,this.Fa.height))},flush:function(){},translate:function(m,E){this.transform(1,0,0,1,m,E)}});c.makeRenderer=function(m){return new I(m)},c.renderFactory={makeRenderPaint:function(){return new Q},makeRenderPath:function(){return new k},makeRenderImage:function(){return new b}};let Xe=c.load,Lt=null;c.load=function(m){return new Promise(function(E){let j=null;Lt={total:0,loaded:0,ready:function(){E(j)}},j=Xe(m),Lt.total==0&&E(j)})},i=new oe,c.requestAnimationFrame=i.requestAnimationFrame.bind(i),c.cancelAnimationFrame=i.cancelAnimationFrame.bind(i),c.enableFPSCounter=i.lb.bind(i),c.disableFPSCounter=i.ib,i.Qa=r,c.cleanup=function(){S&&S.delete()}};var Be=Object.assign({},c),W="./this.program",be=typeof window=="object",Y=typeof importScripts=="function",te="",we,xe;(be||Y)&&(Y?te=self.location.href:typeof document<"u"&&document.currentScript&&(te=document.currentScript.src),ie&&(te=ie),te.indexOf("blob:")!==0?te=te.substr(0,te.replace(/[?#].*/,"").lastIndexOf("/")+1):te="",Y&&(xe=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),we=(t,e,r)=>{var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=()=>{i.status==200||i.status==0&&i.response?e(i.response):r()},i.onerror=r,i.send(null)});var ae=c.print||console.log.bind(console),ge=c.printErr||console.error.bind(console);Object.assign(c,Be),Be=null,c.thisProgram&&(W=c.thisProgram);var o;c.wasmBinary&&(o=c.wasmBinary),c.noExitRuntime,typeof WebAssembly!="object"&&mt("no native wasm support detected");var n,a=!1,d,v,g,w,A,M,P,x;function Z(){var t=n.buffer;c.HEAP8=d=new Int8Array(t),c.HEAP16=g=new Int16Array(t),c.HEAP32=A=new Int32Array(t),c.HEAPU8=v=new Uint8Array(t),c.HEAPU16=w=new Uint16Array(t),c.HEAPU32=M=new Uint32Array(t),c.HEAPF32=P=new Float32Array(t),c.HEAPF64=x=new Float64Array(t)}var ne,U=[],se=[],ye=[];function sn(){var t=c.preRun.shift();U.unshift(t)}var $e=0,Ge=null;function mt(t){throw c.onAbort&&c.onAbort(t),t="Aborted("+t+")",ge(t),a=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),Ae(t),t}function St(t){return t.startsWith("data:application/octet-stream;base64,")}var Ye;if(Ye="canvas_advanced.wasm",!St(Ye)){var Wt=Ye;Ye=c.locateFile?c.locateFile(Wt,te):te+Wt}function Ot(t){if(t==Ye&&o)return new Uint8Array(o);if(xe)return xe(t);throw"both async and sync fetching of the wasm failed"}function un(t){if(!o&&(be||Y)){if(typeof fetch=="function"&&!t.startsWith("file://"))return fetch(t,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw"failed to load wasm binary file at '"+t+"'";return e.arrayBuffer()}).catch(()=>Ot(t));if(we)return new Promise((e,r)=>{we(t,i=>e(new Uint8Array(i)),r)})}return Promise.resolve().then(()=>Ot(t))}function xt(t,e,r){return un(t).then(i=>WebAssembly.instantiate(i,e)).then(i=>i).then(r,i=>{ge("failed to asynchronously prepare wasm: "+i),mt(i)})}function cn(t,e){var r=Ye;return o||typeof WebAssembly.instantiateStreaming!="function"||St(r)||r.startsWith("file://")||typeof fetch!="function"?xt(r,t,e):fetch(r,{credentials:"same-origin"}).then(i=>WebAssembly.instantiateStreaming(i,t).then(e,function(s){return ge("wasm streaming compile failed: "+s),ge("falling back to ArrayBuffer instantiation"),xt(r,t,e)}))}var gt=t=>{for(;0<t.length;)t.shift()(c)};function It(t){if(t===void 0)return"_unknown";t=t.replace(/[^a-zA-Z0-9_]/g,"$");var e=t.charCodeAt(0);return 48<=e&&57>=e?`_${t}`:t}function nt(t,e){return t=It(t),{[t]:function(){return e.apply(this,arguments)}}[t]}function Ft(){this.ja=[void 0],this.Oa=[]}var he=new Ft,Ne=void 0;function L(t){throw new Ne(t)}var Ie=t=>(t||L("Cannot use deleted val. handle = "+t),he.get(t).value),Ee=t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return he.Ya({Ta:1,value:t})}};function Xt(t){var e=Error,r=nt(t,function(i){this.name=t,this.message=i,i=Error(i).stack,i!==void 0&&(this.stack=this.toString()+`
`+i.replace(/^Error(:[^\n]*)?\n/,""))});return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},r}var $t=void 0,jt=void 0;function G(t){for(var e="";v[t];)e+=jt[v[t++]];return e}var Ze=[];function yt(){for(;Ze.length;){var t=Ze.pop();t.W.na=!1,t.delete()}}var Qe=void 0,Ce={};function bt(t,e){for(e===void 0&&L("ptr should not be undefined");t.$;)e=t.ra(e),t=t.$;return e}var je={};function Dt(t){t=Jt(t);var e=G(t);return Le(t),e}function qe(t,e){var r=je[t];return r===void 0&&L(e+" has unknown type "+Dt(t)),r}function rt(){}var wt=!1;function kt(t){--t.count.value,t.count.value===0&&(t.ca?t.fa.ka(t.ca):t.Z.X.ka(t.Y))}function Ut(t,e,r){return e===r?t:r.$===void 0?null:(t=Ut(t,e,r.$),t===null?null:r.jb(t))}var Bt={};function ln(t,e){return e=bt(t,e),Ce[e]}var Yt=void 0;function it(t){throw new Yt(t)}function at(t,e){return e.Z&&e.Y||it("makeClassHandle requires ptr and ptrType"),!!e.fa!=!!e.ca&&it("Both smartPtrType and smartPtr must be specified"),e.count={value:1},ze(Object.create(t,{W:{value:e}}))}function ze(t){return typeof FinalizationRegistry>"u"?(ze=e=>e,t):(wt=new FinalizationRegistry(e=>{kt(e.W)}),ze=e=>{var r=e.W;return r.ca&&wt.register(e,{W:r},e),e},rt=e=>{wt.unregister(e)},ze(t))}var ot={};function Ke(t){for(;t.length;){var e=t.pop();t.pop()(e)}}function Je(t){return this.fromWireType(A[t>>2])}var Ve={},st={};function ue(t,e,r){function i(l){l=r(l),l.length!==t.length&&it("Mismatched type converter count");for(var p=0;p<t.length;++p)Te(t[p],l[p])}t.forEach(function(l){st[l]=e});var s=Array(e.length),u=[],f=0;e.forEach((l,p)=>{je.hasOwnProperty(l)?s[p]=je[l]:(u.push(l),Ve.hasOwnProperty(l)||(Ve[l]=[]),Ve[l].push(()=>{s[p]=je[l],++f,f===u.length&&i(s)}))}),u.length===0&&i(s)}function ut(t){switch(t){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${t}`)}}function fn(t,e,r={}){var i=e.name;if(t||L(`type "${i}" must have a positive integer typeid pointer`),je.hasOwnProperty(t)){if(r.tb)return;L(`Cannot register type '${i}' twice`)}je[t]=e,delete st[t],Ve.hasOwnProperty(t)&&(e=Ve[t],delete Ve[t],e.forEach(s=>s()))}function Te(t,e,r={}){if(!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");fn(t,e,r)}function Tt(t){L(t.W.Z.X.name+" instance already deleted")}function Fe(){}function Rt(t,e,r){if(t[e].aa===void 0){var i=t[e];t[e]=function(){return t[e].aa.hasOwnProperty(arguments.length)||L(`Function '${r}' called with an invalid number of arguments (${arguments.length}) - expects one of (${t[e].aa})!`),t[e].aa[arguments.length].apply(this,arguments)},t[e].aa=[],t[e].aa[i.ma]=i}}function Pt(t,e,r){c.hasOwnProperty(t)?((r===void 0||c[t].aa!==void 0&&c[t].aa[r]!==void 0)&&L(`Cannot register public name '${t}' twice`),Rt(c,t,t),c.hasOwnProperty(r)&&L(`Cannot register multiple overloads of a function with the same number of arguments (${r})!`),c[t].aa[r]=e):(c[t]=e,r!==void 0&&(c[t].Hb=r))}function hn(t,e,r,i,s,u,f,l){this.name=t,this.constructor=e,this.ga=r,this.ka=i,this.$=s,this.ob=u,this.ra=f,this.jb=l,this.Ra=[]}function ct(t,e,r){for(;e!==r;)e.ra||L(`Expected null or instance of ${r.name}, got an instance of ${e.name}`),t=e.ra(t),e=e.$;return t}function dn(t,e){return e===null?(this.Aa&&L(`null is not a valid ${this.name}`),0):(e.W||L(`Cannot pass "${Et(e)}" as a ${this.name}`),e.W.Y||L(`Cannot pass deleted object as a pointer of type ${this.name}`),ct(e.W.Y,e.W.Z.X,this.X))}function pn(t,e){if(e===null){if(this.Aa&&L(`null is not a valid ${this.name}`),this.ua){var r=this.Ba();return t!==null&&t.push(this.ka,r),r}return 0}if(e.W||L(`Cannot pass "${Et(e)}" as a ${this.name}`),e.W.Y||L(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&e.W.Z.ta&&L(`Cannot convert argument of type ${e.W.fa?e.W.fa.name:e.W.Z.name} to parameter type ${this.name}`),r=ct(e.W.Y,e.W.Z.X,this.X),this.ua)switch(e.W.ca===void 0&&L("Passing raw pointer to smart pointer is illegal"),this.Fb){case 0:e.W.fa===this?r=e.W.ca:L(`Cannot convert argument of type ${e.W.fa?e.W.fa.name:e.W.Z.name} to parameter type ${this.name}`);break;case 1:r=e.W.ca;break;case 2:if(e.W.fa===this)r=e.W.ca;else{var i=e.clone();r=this.Bb(r,Ee(function(){i.delete()})),t!==null&&t.push(this.ka,r)}break;default:L("Unsupporting sharing policy")}return r}function vn(t,e){return e===null?(this.Aa&&L(`null is not a valid ${this.name}`),0):(e.W||L(`Cannot pass "${Et(e)}" as a ${this.name}`),e.W.Y||L(`Cannot pass deleted object as a pointer of type ${this.name}`),e.W.Z.ta&&L(`Cannot convert argument of type ${e.W.Z.name} to parameter type ${this.name}`),ct(e.W.Y,e.W.Z.X,this.X))}function Me(t,e,r,i){this.name=t,this.X=e,this.Aa=r,this.ta=i,this.ua=!1,this.ka=this.Bb=this.Ba=this.Sa=this.Fb=this.Ab=void 0,e.$!==void 0?this.toWireType=pn:(this.toWireType=i?dn:vn,this.ea=null)}function Nt(t,e,r){c.hasOwnProperty(t)||it("Replacing nonexistant public symbol"),c[t].aa!==void 0&&r!==void 0?c[t].aa[r]=e:(c[t]=e,c[t].ma=r)}var mn=(t,e)=>{var r=[];return function(){if(r.length=0,Object.assign(r,arguments),t.includes("j")){var i=c["dynCall_"+t];i=r&&r.length?i.apply(null,[e].concat(r)):i.call(null,e)}else i=ne.get(e).apply(null,r);return i}};function re(t,e){t=G(t);var r=t.includes("j")?mn(t,e):ne.get(e);return typeof r!="function"&&L(`unknown function pointer with signature ${t}: ${e}`),r}var zt=void 0;function _e(t,e){function r(u){s[u]||je[u]||(st[u]?st[u].forEach(r):(i.push(u),s[u]=!0))}var i=[],s={};throw e.forEach(r),new zt(`${t}: `+i.map(Dt).join([", "]))}function lt(t,e,r,i,s){var u=e.length;2>u&&L("argTypes array size mismatch! Must at least get return value and 'this' types!");var f=e[1]!==null&&r!==null,l=!1;for(r=1;r<e.length;++r)if(e[r]!==null&&e[r].ea===void 0){l=!0;break}var p=e[0].name!=="void",h=u-2,y=Array(h),T=[],R=[];return function(){if(arguments.length!==h&&L(`function ${t} called with ${arguments.length} arguments, expected ${h} args!`),R.length=0,T.length=f?2:1,T[0]=s,f){var C=e[1].toWireType(R,this);T[1]=C}for(var b=0;b<h;++b)y[b]=e[b+2].toWireType(R,arguments[b]),T.push(y[b]);if(b=i.apply(null,T),l)Ke(R);else for(var k=f?1:2;k<e.length;k++){var Q=k===1?C:y[k-2];e[k].ea!==null&&e[k].ea(Q)}return C=p?e[0].fromWireType(b):void 0,C}}function ft(t,e){for(var r=[],i=0;i<t;i++)r.push(M[e+4*i>>2]);return r}function Vt(t,e,r){return t instanceof Object||L(`${r} with invalid "this": ${t}`),t instanceof e.X.constructor||L(`${r} incompatible with "this" of type ${t.constructor.name}`),t.W.Y||L(`cannot call emscripten binding method ${r} on deleted object`),ct(t.W.Y,t.W.Z.X,e.X)}function At(t){t>=he.Ea&&--he.get(t).Ta===0&&he.Za(t)}function gn(t,e,r){switch(e){case 0:return function(i){return this.fromWireType((r?d:v)[i])};case 1:return function(i){return this.fromWireType((r?g:w)[i>>1])};case 2:return function(i){return this.fromWireType((r?A:M)[i>>2])};default:throw new TypeError("Unknown integer type: "+t)}}function Et(t){if(t===null)return"null";var e=typeof t;return e==="object"||e==="array"||e==="function"?t.toString():""+t}function yn(t,e){switch(e){case 2:return function(r){return this.fromWireType(P[r>>2])};case 3:return function(r){return this.fromWireType(x[r>>3])};default:throw new TypeError("Unknown float type: "+t)}}function bn(t,e,r){switch(e){case 0:return r?function(i){return d[i]}:function(i){return v[i]};case 1:return r?function(i){return g[i>>1]}:function(i){return w[i>>1]};case 2:return r?function(i){return A[i>>2]}:function(i){return M[i>>2]};default:throw new TypeError("Unknown integer type: "+t)}}var Ht=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Gt=(t,e,r)=>{var i=e+r;for(r=e;t[r]&&!(r>=i);)++r;if(16<r-e&&t.buffer&&Ht)return Ht.decode(t.subarray(e,r));for(i="";e<r;){var s=t[e++];if(s&128){var u=t[e++]&63;if((s&224)==192)i+=String.fromCharCode((s&31)<<6|u);else{var f=t[e++]&63;s=(s&240)==224?(s&15)<<12|u<<6|f:(s&7)<<18|u<<12|f<<6|t[e++]&63,65536>s?i+=String.fromCharCode(s):(s-=65536,i+=String.fromCharCode(55296|s>>10,56320|s&1023))}}else i+=String.fromCharCode(s)}return i},Zt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,wn=(t,e)=>{for(var r=t>>1,i=r+e/2;!(r>=i)&&w[r];)++r;if(r<<=1,32<r-t&&Zt)return Zt.decode(v.subarray(t,r));for(r="",i=0;!(i>=e/2);++i){var s=g[t+2*i>>1];if(s==0)break;r+=String.fromCharCode(s)}return r},Tn=(t,e,r)=>{if(r===void 0&&(r=2147483647),2>r)return 0;r-=2;var i=e;r=r<2*t.length?r/2:t.length;for(var s=0;s<r;++s)g[e>>1]=t.charCodeAt(s),e+=2;return g[e>>1]=0,e-i},Rn=t=>2*t.length,Pn=(t,e)=>{for(var r=0,i="";!(r>=e/4);){var s=A[t+4*r>>2];if(s==0)break;++r,65536<=s?(s-=65536,i+=String.fromCharCode(55296|s>>10,56320|s&1023)):i+=String.fromCharCode(s)}return i},An=(t,e,r)=>{if(r===void 0&&(r=2147483647),4>r)return 0;var i=e;r=i+r-4;for(var s=0;s<t.length;++s){var u=t.charCodeAt(s);if(55296<=u&&57343>=u){var f=t.charCodeAt(++s);u=65536+((u&1023)<<10)|f&1023}if(A[e>>2]=u,e+=4,e+4>r)break}return A[e>>2]=0,e-i},En=t=>{for(var e=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);55296<=i&&57343>=i&&++r,e+=4}return e},Cn={};function ht(t){var e=Cn[t];return e===void 0?G(t):e}var dt=[];function Mn(t){var e=dt.length;return dt.push(t),e}function _n(t,e){for(var r=Array(t),i=0;i<t;++i)r[i]=qe(M[e+4*i>>2],"parameter "+i);return r}var Qt=[],Ct={},qt=()=>{if(!Mt){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:W||"./this.program"},e;for(e in Ct)Ct[e]===void 0?delete t[e]:t[e]=Ct[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);Mt=r}return Mt},Mt,Ln=[null,[],[]];Object.assign(Ft.prototype,{get(t){return this.ja[t]},has(t){return this.ja[t]!==void 0},Ya(t){var e=this.Oa.pop()||this.ja.length;return this.ja[e]=t,e},Za(t){this.ja[t]=void 0,this.Oa.push(t)}}),Ne=c.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},he.ja.push({value:void 0},{value:null},{value:!0},{value:!1}),he.Ea=he.ja.length,c.count_emval_handles=function(){for(var t=0,e=he.Ea;e<he.ja.length;++e)he.ja[e]!==void 0&&++t;return t},$t=c.PureVirtualError=Xt("PureVirtualError");for(var Kt=Array(256),pt=0;256>pt;++pt)Kt[pt]=String.fromCharCode(pt);jt=Kt,c.getInheritedInstanceCount=function(){return Object.keys(Ce).length},c.getLiveInheritedInstances=function(){var t=[],e;for(e in Ce)Ce.hasOwnProperty(e)&&t.push(Ce[e]);return t},c.flushPendingDeletes=yt,c.setDelayFunction=function(t){Qe=t,Ze.length&&Qe&&Qe(yt)},Yt=c.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}},Fe.prototype.isAliasOf=function(t){if(!(this instanceof Fe&&t instanceof Fe))return!1;var e=this.W.Z.X,r=this.W.Y,i=t.W.Z.X;for(t=t.W.Y;e.$;)r=e.ra(r),e=e.$;for(;i.$;)t=i.ra(t),i=i.$;return e===i&&r===t},Fe.prototype.clone=function(){if(this.W.Y||Tt(this),this.W.pa)return this.W.count.value+=1,this;var t=ze,e=Object,r=e.create,i=Object.getPrototypeOf(this),s=this.W;return t=t(r.call(e,i,{W:{value:{count:s.count,na:s.na,pa:s.pa,Y:s.Y,Z:s.Z,ca:s.ca,fa:s.fa}}})),t.W.count.value+=1,t.W.na=!1,t},Fe.prototype.delete=function(){this.W.Y||Tt(this),this.W.na&&!this.W.pa&&L("Object already scheduled for deletion"),rt(this),kt(this.W),this.W.pa||(this.W.ca=void 0,this.W.Y=void 0)},Fe.prototype.isDeleted=function(){return!this.W.Y},Fe.prototype.deleteLater=function(){return this.W.Y||Tt(this),this.W.na&&!this.W.pa&&L("Object already scheduled for deletion"),Ze.push(this),Ze.length===1&&Qe&&Qe(yt),this.W.na=!0,this},Me.prototype.pb=function(t){return this.Sa&&(t=this.Sa(t)),t},Me.prototype.Ka=function(t){this.ka&&this.ka(t)},Me.prototype.argPackAdvance=8,Me.prototype.readValueFromPointer=Je,Me.prototype.deleteObject=function(t){t!==null&&t.delete()},Me.prototype.fromWireType=function(t){function e(){return this.ua?at(this.X.ga,{Z:this.Ab,Y:r,fa:this,ca:t}):at(this.X.ga,{Z:this,Y:t})}var r=this.pb(t);if(!r)return this.Ka(t),null;var i=ln(this.X,r);if(i!==void 0)return i.W.count.value===0?(i.W.Y=r,i.W.ca=t,i.clone()):(i=i.clone(),this.Ka(t),i);if(i=this.X.ob(r),i=Bt[i],!i)return e.call(this);i=this.ta?i.fb:i.pointerType;var s=Ut(r,this.X,i.X);return s===null?e.call(this):this.ua?at(i.X.ga,{Z:i,Y:s,fa:this,ca:t}):at(i.X.ga,{Z:i,Y:s})},zt=c.UnboundTypeError=Xt("UnboundTypeError");var Sn={I:function(t,e,r){t=G(t),e=qe(e,"wrapper"),r=Ie(r);var i=[].slice,s=e.X,u=s.ga,f=s.$.ga,l=s.$.constructor;t=nt(t,function(){s.$.Ra.forEach(function(h){if(this[h]===f[h])throw new $t(`Pure virtual function ${h} must be implemented in JavaScript`)}.bind(this)),Object.defineProperty(this,"__parent",{value:u}),this.__construct.apply(this,i.call(arguments))}),u.__construct=function(){this===u&&L("Pass correct 'this' to __construct");var h=l.implement.apply(void 0,[this].concat(i.call(arguments)));rt(h);var y=h.W;h.notifyOnDestruction(),y.pa=!0,Object.defineProperties(this,{W:{value:y}}),ze(this),h=y.Y,h=bt(s,h),Ce.hasOwnProperty(h)?L(`Tried to register registered instance: ${h}`):Ce[h]=this},u.__destruct=function(){this===u&&L("Pass correct 'this' to __destruct"),rt(this);var h=this.W.Y;h=bt(s,h),Ce.hasOwnProperty(h)?delete Ce[h]:L(`Tried to unregister unregistered instance: ${h}`)},t.prototype=Object.create(u);for(var p in r)t.prototype[p]=r[p];return Ee(t)},L:function(t){var e=ot[t];delete ot[t];var r=e.Ba,i=e.ka,s=e.Na,u=s.map(f=>f.sb).concat(s.map(f=>f.Db));ue([t],u,f=>{var l={};return s.forEach((p,h)=>{var y=f[h],T=p.qb,R=p.rb,C=f[h+s.length],b=p.Cb,k=p.Eb;l[p.mb]={read:Q=>y.fromWireType(T(R,Q)),write:(Q,_)=>{var S=[];b(k,Q,C.toWireType(S,_)),Ke(S)}}}),[{name:e.name,fromWireType:function(p){var h={},y;for(y in l)h[y]=l[y].read(p);return i(p),h},toWireType:function(p,h){for(var y in l)if(!(y in h))throw new TypeError(`Missing field: "${y}"`);var T=r();for(y in l)l[y].write(T,h[y]);return p!==null&&p.push(i,T),T},argPackAdvance:8,readValueFromPointer:Je,ea:i}]})},z:function(){},G:function(t,e,r,i,s){var u=ut(r);e=G(e),Te(t,{name:e,fromWireType:function(f){return!!f},toWireType:function(f,l){return l?i:s},argPackAdvance:8,readValueFromPointer:function(f){if(r===1)var l=d;else if(r===2)l=g;else if(r===4)l=A;else throw new TypeError("Unknown boolean type size: "+e);return this.fromWireType(l[f>>u])},ea:null})},e:function(t,e,r,i,s,u,f,l,p,h,y,T,R){y=G(y),u=re(s,u),l&&(l=re(f,l)),h&&(h=re(p,h)),R=re(T,R);var C=It(y);Pt(C,function(){_e(`Cannot construct ${y} due to unbound types`,[i])}),ue([t,e,r],i?[i]:[],function(b){if(b=b[0],i)var k=b.X,Q=k.ga;else Q=Fe.prototype;b=nt(C,function(){if(Object.getPrototypeOf(this)!==_)throw new Ne("Use 'new' to construct "+y);if(S.la===void 0)throw new Ne(y+" has no accessible constructor");var ce=S.la[arguments.length];if(ce===void 0)throw new Ne(`Tried to invoke ctor of ${y} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(S.la).toString()}) parameters instead!`);return ce.apply(this,arguments)});var _=Object.create(Q,{constructor:{value:b}});b.prototype=_;var S=new hn(y,b,_,R,k,u,l,h);S.$&&(S.$.sa===void 0&&(S.$.sa=[]),S.$.sa.push(S)),k=new Me(y,S,!0,!1),Q=new Me(y+"*",S,!1,!1);var q=new Me(y+" const*",S,!1,!0);return Bt[t]={pointerType:Q,fb:q},Nt(C,b),[k,Q,q]})},k:function(t,e,r,i,s,u,f){var l=ft(r,i);e=G(e),u=re(s,u),ue([],[t],function(p){function h(){_e(`Cannot call ${y} due to unbound types`,l)}p=p[0];var y=`${p.name}.${e}`;e.startsWith("@@")&&(e=Symbol[e.substring(2)]);var T=p.X.constructor;return T[e]===void 0?(h.ma=r-1,T[e]=h):(Rt(T,e,y),T[e].aa[r-1]=h),ue([],l,function(R){if(R=lt(y,[R[0],null].concat(R.slice(1)),null,u,f),T[e].aa===void 0?(R.ma=r-1,T[e]=R):T[e].aa[r-1]=R,p.X.sa)for(const C of p.X.sa)C.constructor.hasOwnProperty(e)||(C.constructor[e]=R);return[]}),[]})},s:function(t,e,r,i,s,u,f,l){e=G(e),u=re(s,u),ue([],[t],function(p){p=p[0];var h=`${p.name}.${e}`,y={get(){_e(`Cannot access ${h} due to unbound types`,[r])},enumerable:!0,configurable:!0};return y.set=l?()=>{_e(`Cannot access ${h} due to unbound types`,[r])}:()=>{L(`${h} is a read-only property`)},Object.defineProperty(p.X.constructor,e,y),ue([],[r],function(T){T=T[0];var R={get(){return T.fromWireType(u(i))},enumerable:!0};return l&&(l=re(f,l),R.set=C=>{var b=[];l(i,T.toWireType(b,C)),Ke(b)}),Object.defineProperty(p.X.constructor,e,R),[]}),[]})},o:function(t,e,r,i,s,u){var f=ft(e,r);s=re(i,s),ue([],[t],function(l){l=l[0];var p=`constructor ${l.name}`;if(l.X.la===void 0&&(l.X.la=[]),l.X.la[e-1]!==void 0)throw new Ne(`Cannot register multiple constructors with identical number of parameters (${e-1}) for class '${l.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return l.X.la[e-1]=()=>{_e(`Cannot construct ${l.name} due to unbound types`,f)},ue([],f,function(h){return h.splice(1,0,null),l.X.la[e-1]=lt(p,h,null,s,u),[]}),[]})},a:function(t,e,r,i,s,u,f,l){var p=ft(r,i);e=G(e),u=re(s,u),ue([],[t],function(h){function y(){_e(`Cannot call ${T} due to unbound types`,p)}h=h[0];var T=`${h.name}.${e}`;e.startsWith("@@")&&(e=Symbol[e.substring(2)]),l&&h.X.Ra.push(e);var R=h.X.ga,C=R[e];return C===void 0||C.aa===void 0&&C.className!==h.name&&C.ma===r-2?(y.ma=r-2,y.className=h.name,R[e]=y):(Rt(R,e,T),R[e].aa[r-2]=y),ue([],p,function(b){return b=lt(T,b,h,u,f),R[e].aa===void 0?(b.ma=r-2,R[e]=b):R[e].aa[r-2]=b,[]}),[]})},d:function(t,e,r,i,s,u,f,l,p,h){e=G(e),s=re(i,s),ue([],[t],function(y){y=y[0];var T=`${y.name}.${e}`,R={get(){_e(`Cannot access ${T} due to unbound types`,[r,f])},enumerable:!0,configurable:!0};return R.set=p?()=>{_e(`Cannot access ${T} due to unbound types`,[r,f])}:()=>{L(T+" is a read-only property")},Object.defineProperty(y.X.ga,e,R),ue([],p?[r,f]:[r],function(C){var b=C[0],k={get(){var _=Vt(this,y,T+" getter");return b.fromWireType(s(u,_))},enumerable:!0};if(p){p=re(l,p);var Q=C[1];k.set=function(_){var S=Vt(this,y,T+" setter"),q=[];p(h,S,Q.toWireType(q,_)),Ke(q)}}return Object.defineProperty(y.X.ga,e,k),[]}),[]})},F:function(t,e){e=G(e),Te(t,{name:e,fromWireType:function(r){var i=Ie(r);return At(r),i},toWireType:function(r,i){return Ee(i)},argPackAdvance:8,readValueFromPointer:Je,ea:null})},l:function(t,e,r,i){function s(){}r=ut(r),e=G(e),s.values={},Te(t,{name:e,constructor:s,fromWireType:function(u){return this.constructor.values[u]},toWireType:function(u,f){return f.value},argPackAdvance:8,readValueFromPointer:gn(e,r,i),ea:null}),Pt(e,s)},c:function(t,e,r){var i=qe(t,"enum");e=G(e),t=i.constructor,i=Object.create(i.constructor.prototype,{value:{value:r},constructor:{value:nt(`${i.name}_${e}`,function(){})}}),t.values[r]=i,t[e]=i},u:function(t,e,r){r=ut(r),e=G(e),Te(t,{name:e,fromWireType:function(i){return i},toWireType:function(i,s){return s},argPackAdvance:8,readValueFromPointer:yn(e,r),ea:null})},q:function(t,e,r,i,s,u){var f=ft(e,r);t=G(t),s=re(i,s),Pt(t,function(){_e(`Cannot call ${t} due to unbound types`,f)},e-1),ue([],f,function(l){return Nt(t,lt(t,[l[0],null].concat(l.slice(1)),null,s,u),e-1),[]})},j:function(t,e,r,i,s){e=G(e),s===-1&&(s=4294967295),s=ut(r);var u=l=>l;if(i===0){var f=32-8*r;u=l=>l<<f>>>f}r=e.includes("unsigned")?function(l,p){return p>>>0}:function(l,p){return p},Te(t,{name:e,fromWireType:u,toWireType:r,argPackAdvance:8,readValueFromPointer:bn(e,s,i!==0),ea:null})},g:function(t,e,r){function i(u){u>>=2;var f=M;return new s(f.buffer,f[u+1],f[u])}var s=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];r=G(r),Te(t,{name:r,fromWireType:i,argPackAdvance:8,readValueFromPointer:i},{tb:!0})},v:function(t,e){e=G(e);var r=e==="std::string";Te(t,{name:e,fromWireType:function(i){var s=M[i>>2],u=i+4;if(r)for(var f=u,l=0;l<=s;++l){var p=u+l;if(l==s||v[p]==0){if(f=f?Gt(v,f,p-f):"",h===void 0)var h=f;else h+=String.fromCharCode(0),h+=f;f=p+1}}else{for(h=Array(s),l=0;l<s;++l)h[l]=String.fromCharCode(v[u+l]);h=h.join("")}return Le(i),h},toWireType:function(i,s){s instanceof ArrayBuffer&&(s=new Uint8Array(s));var u,f=typeof s=="string";f||s instanceof Uint8Array||s instanceof Uint8ClampedArray||s instanceof Int8Array||L("Cannot pass non-string to std::string");var l;if(r&&f)for(u=l=0;u<s.length;++u){var p=s.charCodeAt(u);127>=p?l++:2047>=p?l+=2:55296<=p&&57343>=p?(l+=4,++u):l+=3}else l=s.length;if(u=l,l=_t(4+u+1),p=l+4,M[l>>2]=u,r&&f){if(f=p,p=u+1,u=v,0<p){p=f+p-1;for(var h=0;h<s.length;++h){var y=s.charCodeAt(h);if(55296<=y&&57343>=y){var T=s.charCodeAt(++h);y=65536+((y&1023)<<10)|T&1023}if(127>=y){if(f>=p)break;u[f++]=y}else{if(2047>=y){if(f+1>=p)break;u[f++]=192|y>>6}else{if(65535>=y){if(f+2>=p)break;u[f++]=224|y>>12}else{if(f+3>=p)break;u[f++]=240|y>>18,u[f++]=128|y>>12&63}u[f++]=128|y>>6&63}u[f++]=128|y&63}}u[f]=0}}else if(f)for(f=0;f<u;++f)h=s.charCodeAt(f),255<h&&(Le(p),L("String has UTF-16 code units that do not fit in 8 bits")),v[p+f]=h;else for(f=0;f<u;++f)v[p+f]=s[f];return i!==null&&i.push(Le,l),l},argPackAdvance:8,readValueFromPointer:Je,ea:function(i){Le(i)}})},t:function(t,e,r){if(r=G(r),e===2)var i=wn,s=Tn,u=Rn,f=()=>w,l=1;else e===4&&(i=Pn,s=An,u=En,f=()=>M,l=2);Te(t,{name:r,fromWireType:function(p){for(var h=M[p>>2],y=f(),T,R=p+4,C=0;C<=h;++C){var b=p+4+C*e;(C==h||y[b>>l]==0)&&(R=i(R,b-R),T===void 0?T=R:(T+=String.fromCharCode(0),T+=R),R=b+e)}return Le(p),T},toWireType:function(p,h){typeof h!="string"&&L(`Cannot pass non-string to C++ string type ${r}`);var y=u(h),T=_t(4+y+e);return M[T>>2]=y>>l,s(h,T+4,y+e),p!==null&&p.push(Le,T),T},argPackAdvance:8,readValueFromPointer:Je,ea:function(p){Le(p)}})},N:function(t,e,r,i,s,u){ot[t]={name:G(e),Ba:re(r,i),ka:re(s,u),Na:[]}},M:function(t,e,r,i,s,u,f,l,p,h){ot[t].Na.push({mb:G(e),sb:r,qb:re(i,s),rb:u,Db:f,Cb:re(l,p),Eb:h})},H:function(t,e){e=G(e),Te(t,{vb:!0,name:e,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},r:function(t,e,r){t=Ie(t),e=qe(e,"emval::as");var i=[],s=Ee(i);return M[r>>2]=s,e.toWireType(i,t)},w:function(t,e,r,i,s){t=dt[t],e=Ie(e),r=ht(r);var u=[];return M[i>>2]=Ee(u),t(e,r,u,s)},i:function(t,e,r,i){t=dt[t],e=Ie(e),r=ht(r),t(e,r,null,i)},f:At,h:function(t,e){var r=_n(t,e),i=r[0];e=i.name+"_$"+r.slice(1).map(function(f){return f.name}).join("_")+"$";var s=Qt[e];if(s!==void 0)return s;var u=Array(t-1);return s=Mn((f,l,p,h)=>{for(var y=0,T=0;T<t-1;++T)u[T]=r[T+1].readValueFromPointer(h+y),y+=r[T+1].argPackAdvance;for(f=f[l].apply(f,u),T=0;T<t-1;++T)r[T+1].hb&&r[T+1].hb(u[T]);if(!i.vb)return i.toWireType(p,f)}),Qt[e]=s},p:function(t){return t=ht(t),Ee(c[t])},K:function(t,e){return t=Ie(t),e=Ie(e),Ee(t[e])},m:function(t){4<t&&(he.get(t).Ta+=1)},J:function(t){return Ee(ht(t))},n:function(t){var e=Ie(t);Ke(e),At(t)},x:function(t,e){return t=qe(t,"_emval_take_value"),t=t.readValueFromPointer(e),Ee(t)},b:()=>{mt("")},A:t=>{var e=v.length;if(t>>>=0,2147483648<t)return!1;for(var r=1;4>=r;r*=2){var i=e*(1+.2/r);i=Math.min(i,t+100663296);var s=Math;i=Math.max(t,i);e:{s=s.min.call(s,2147483648,i+(65536-i%65536)%65536)-n.buffer.byteLength+65535>>>16;try{n.grow(s),Z();var u=1;break e}catch{}u=void 0}if(u)return!0}return!1},B:(t,e)=>{var r=0;return qt().forEach(function(i,s){var u=e+r;for(s=M[t+4*s>>2]=u,u=0;u<i.length;++u)d[s++>>0]=i.charCodeAt(u);d[s>>0]=0,r+=i.length+1}),0},C:(t,e)=>{var r=qt();M[t>>2]=r.length;var i=0;return r.forEach(function(s){i+=s.length+1}),M[e>>2]=i,0},D:()=>52,y:function(){return 70},E:(t,e,r,i)=>{for(var s=0,u=0;u<r;u++){var f=M[e>>2],l=M[e+4>>2];e+=8;for(var p=0;p<l;p++){var h=v[f+p],y=Ln[t];h===0||h===10?((t===1?ae:ge)(Gt(y,0)),y.length=0):y.push(h)}s+=l}return M[i>>2]=s,0}};(function(){function t(r){if(r=r.exports,c.asm=r,n=c.asm.O,Z(),ne=c.asm.U,se.unshift(c.asm.P),$e--,c.monitorRunDependencies&&c.monitorRunDependencies($e),$e==0&&Ge){var i=Ge;Ge=null,i()}return r}var e={a:Sn};if($e++,c.monitorRunDependencies&&c.monitorRunDependencies($e),c.instantiateWasm)try{return c.instantiateWasm(e,t)}catch(r){ge("Module.instantiateWasm callback failed with error: "+r),Ae(r)}return cn(e,function(r){t(r.instance)}).catch(Ae),{}})();function Le(){return(Le=c.asm.Q).apply(null,arguments)}function _t(){return(_t=c.asm.R).apply(null,arguments)}function Jt(){return(Jt=c.asm.S).apply(null,arguments)}c.__embind_initialize_bindings=function(){return(c.__embind_initialize_bindings=c.asm.T).apply(null,arguments)},c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.V).apply(null,arguments)};var vt;Ge=function t(){vt||en(),vt||(Ge=t)};function en(){function t(){if(!vt&&(vt=!0,c.calledRun=!0,!a)){if(gt(se),le(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;){var e=c.postRun.shift();ye.unshift(e)}gt(ye)}}if(!(0<$e)){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)sn();gt(U),0<$e||(c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),t()},1)):t())}}if(c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);0<c.preInit.length;)c.preInit.pop()();return en(),O.ready}})();const Ue=ve},B=>{B.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"1.2.4","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)},(B,z,V)=>{V.r(z),V.d(z,{registerTouchInteractions:()=>ve.registerTouchInteractions});var ve=V(4)},(B,z,V)=>{V.r(z),V.d(z,{registerTouchInteractions:()=>ie});var ve=void 0,Ue=function(O){var c,le;return["touchstart","touchmove"].indexOf(O.type)>-1&&((c=O.touches)===null||c===void 0?void 0:c.length)?(O.preventDefault(),{clientX:O.touches[0].clientX,clientY:O.touches[0].clientY}):O.type==="touchend"&&((le=O.changedTouches)===null||le===void 0?void 0:le.length)?{clientX:O.changedTouches[0].clientX,clientY:O.changedTouches[0].clientY}:{clientX:O.clientX,clientY:O.clientY}},ie=function(O){var c=O.canvas,le=O.artboard,Ae=O.stateMachines,oe=Ae===void 0?[]:Ae,me=O.renderer,fe=O.rive,Be=O.fit,W=O.alignment;if(!c||!oe.length||!me||!fe||!le||typeof window>"u")return null;var be=function(te){var we=te.currentTarget.getBoundingClientRect(),xe=Ue(te),ae=xe.clientX,ge=xe.clientY;if(!(!ae&&!ge)){var o=ae-we.left,n=ge-we.top,a=fe.computeAlignment(Be,W,{minX:0,minY:0,maxX:we.width,maxY:we.height},le.bounds),d=new fe.Mat2D;a.invert(d);var v=new fe.Vec2D(o,n),g=fe.mapXY(d,v),w=g.x(),A=g.y();switch(g.delete(),d.delete(),v.delete(),a.delete(),te.type){case"touchmove":case"mouseover":case"mouseout":case"mousemove":{for(var M=0,P=oe;M<P.length;M++){var x=P[M];x.pointerMove(w,A)}break}case"touchstart":case"mousedown":{for(var Z=0,ne=oe;Z<ne.length;Z++){var x=ne[Z];x.pointerDown(w,A)}break}case"touchend":case"mouseup":{for(var U=0,se=oe;U<se.length;U++){var x=se[U];x.pointerUp(w,A)}break}}}},Y=be.bind(ve);return c.addEventListener("mouseover",Y),c.addEventListener("mouseout",Y),c.addEventListener("mousemove",Y),c.addEventListener("mousedown",Y),c.addEventListener("mouseup",Y),c.addEventListener("touchmove",Y),c.addEventListener("touchstart",Y),c.addEventListener("touchend",Y),function(){c.removeEventListener("mouseover",Y),c.removeEventListener("mouseout",Y),c.removeEventListener("mousemove",Y),c.removeEventListener("mousedown",Y),c.removeEventListener("mouseup",Y),c.removeEventListener("touchmove",Y),c.removeEventListener("touchstart",Y),c.removeEventListener("touchend",Y)}}}],Pe={};function K(B){var z=Pe[B];if(z!==void 0)return z.exports;var V=Pe[B]={exports:{}};return We[B](V,V.exports,K),V.exports}K.d=(B,z)=>{for(var V in z)K.o(z,V)&&!K.o(B,V)&&Object.defineProperty(B,V,{enumerable:!0,get:z[V]})},K.o=(B,z)=>Object.prototype.hasOwnProperty.call(B,z),K.r=B=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(B,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(B,"__esModule",{value:!0})};var Oe={};return(()=>{K.r(Oe),K.d(Oe,{Alignment:()=>O,EventType:()=>W,Fit:()=>ie,Layout:()=>c,LoopType:()=>be,Rive:()=>we,RuntimeLoader:()=>le,StateMachineInput:()=>me,StateMachineInputType:()=>oe,Testing:()=>ge});var B=K(1),z=K(2),V=K(3),ve=function(o,n,a,d){function v(g){return g instanceof a?g:new a(function(w){w(g)})}return new(a||(a=Promise))(function(g,w){function A(x){try{P(d.next(x))}catch(Z){w(Z)}}function M(x){try{P(d.throw(x))}catch(Z){w(Z)}}function P(x){x.done?g(x.value):v(x.value).then(A,M)}P((d=d.apply(o,n||[])).next())})},Ue=function(o,n){var a={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},d,v,g,w;return w={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function A(P){return function(x){return M([P,x])}}function M(P){if(d)throw new TypeError("Generator is already executing.");for(;w&&(w=0,P[0]&&(a=0)),a;)try{if(d=1,v&&(g=P[0]&2?v.return:P[0]?v.throw||((g=v.return)&&g.call(v),0):v.next)&&!(g=g.call(v,P[1])).done)return g;switch(v=0,g&&(P=[P[0]&2,g.value]),P[0]){case 0:case 1:g=P;break;case 4:return a.label++,{value:P[1],done:!1};case 5:a.label++,v=P[1],P=[0];continue;case 7:P=a.ops.pop(),a.trys.pop();continue;default:if(g=a.trys,!(g=g.length>0&&g[g.length-1])&&(P[0]===6||P[0]===2)){a=0;continue}if(P[0]===3&&(!g||P[1]>g[0]&&P[1]<g[3])){a.label=P[1];break}if(P[0]===6&&a.label<g[1]){a.label=g[1],g=P;break}if(g&&a.label<g[2]){a.label=g[2],a.ops.push(P);break}g[2]&&a.ops.pop(),a.trys.pop();continue}P=n.call(o,a)}catch(x){P=[6,x],v=0}finally{d=g=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},ie;(function(o){o.Cover="cover",o.Contain="contain",o.Fill="fill",o.FitWidth="fitWidth",o.FitHeight="fitHeight",o.None="none",o.ScaleDown="scaleDown"})(ie||(ie={}));var O;(function(o){o.Center="center",o.TopLeft="topLeft",o.TopCenter="topCenter",o.TopRight="topRight",o.CenterLeft="centerLeft",o.CenterRight="centerRight",o.BottomLeft="bottomLeft",o.BottomCenter="bottomCenter",o.BottomRight="bottomRight"})(O||(O={}));var c=function(){function o(n){var a,d,v,g,w,A;this.fit=(a=n==null?void 0:n.fit)!==null&&a!==void 0?a:ie.Contain,this.alignment=(d=n==null?void 0:n.alignment)!==null&&d!==void 0?d:O.Center,this.minX=(v=n==null?void 0:n.minX)!==null&&v!==void 0?v:0,this.minY=(g=n==null?void 0:n.minY)!==null&&g!==void 0?g:0,this.maxX=(w=n==null?void 0:n.maxX)!==null&&w!==void 0?w:0,this.maxY=(A=n==null?void 0:n.maxY)!==null&&A!==void 0?A:0}return o.new=function(n){var a=n.fit,d=n.alignment,v=n.minX,g=n.minY,w=n.maxX,A=n.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new o({fit:a,alignment:d,minX:v,minY:g,maxX:w,maxY:A})},o.prototype.copyWith=function(n){var a=n.fit,d=n.alignment,v=n.minX,g=n.minY,w=n.maxX,A=n.maxY;return new o({fit:a!=null?a:this.fit,alignment:d!=null?d:this.alignment,minX:v!=null?v:this.minX,minY:g!=null?g:this.minY,maxX:w!=null?w:this.maxX,maxY:A!=null?A:this.maxY})},o.prototype.runtimeFit=function(n){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var a;return this.fit===ie.Cover?a=n.Fit.cover:this.fit===ie.Contain?a=n.Fit.contain:this.fit===ie.Fill?a=n.Fit.fill:this.fit===ie.FitWidth?a=n.Fit.fitWidth:this.fit===ie.FitHeight?a=n.Fit.fitHeight:this.fit===ie.ScaleDown?a=n.Fit.scaleDown:a=n.Fit.none,this.cachedRuntimeFit=a,a},o.prototype.runtimeAlignment=function(n){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var a;return this.alignment===O.TopLeft?a=n.Alignment.topLeft:this.alignment===O.TopCenter?a=n.Alignment.topCenter:this.alignment===O.TopRight?a=n.Alignment.topRight:this.alignment===O.CenterLeft?a=n.Alignment.centerLeft:this.alignment===O.CenterRight?a=n.Alignment.centerRight:this.alignment===O.BottomLeft?a=n.Alignment.bottomLeft:this.alignment===O.BottomCenter?a=n.Alignment.bottomCenter:this.alignment===O.BottomRight?a=n.Alignment.bottomRight:a=n.Alignment.center,this.cachedRuntimeAlignment=a,a},o}(),le=function(){function o(){}return o.loadRuntime=function(){B.default({locateFile:function(){return o.wasmURL}}).then(function(n){var a;for(o.runtime=n;o.callBackQueue.length>0;)(a=o.callBackQueue.shift())===null||a===void 0||a(o.runtime)})},o.getInstance=function(n){o.isLoading||(o.isLoading=!0,o.loadRuntime()),o.runtime?n(o.runtime):o.callBackQueue.push(n)},o.awaitInstance=function(){return new Promise(function(n){return o.getInstance(function(a){return n(a)})})},o.setWasmUrl=function(n){o.wasmURL=n},o.isLoading=!1,o.callBackQueue=[],o.wasmURL="https://unpkg.com/".concat(z.name,"@").concat(z.version,"/rive.wasm"),o}(),Ae=function(){function o(n,a,d,v){this.animation=n,this.artboard=a,this.playing=v,this.loopCount=0,this.scrubTo=null,this.instance=new d.LinearAnimationInstance(n,a)}return Object.defineProperty(o.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"time",{get:function(){return this.instance.time},set:function(n){this.instance.time=n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),o.prototype.advance=function(n){this.scrubTo===null?this.instance.advance(n):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},o.prototype.apply=function(n){this.instance.apply(n)},Object.defineProperty(o.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),o.prototype.cleanup=function(){this.instance.delete()},o}(),oe;(function(o){o[o.Number=56]="Number",o[o.Trigger=58]="Trigger",o[o.Boolean=59]="Boolean"})(oe||(oe={}));var me=function(){function o(n,a){this.type=n,this.runtimeInput=a}return Object.defineProperty(o.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(n){this.runtimeInput.value=n},enumerable:!1,configurable:!0}),o.prototype.fire=function(){this.type===oe.Trigger&&this.runtimeInput.fire()},o}(),fe=function(){function o(n,a,d,v){this.stateMachine=n,this.playing=d,this.artboard=v,this.inputs=[],this.instance=new a.StateMachineInstance(n,v),this.initInputs(a)}return Object.defineProperty(o.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"statesChanged",{get:function(){for(var n=[],a=0;a<this.instance.stateChangedCount();a++)n.push(this.instance.stateChangedNameByIndex(a));return n},enumerable:!1,configurable:!0}),o.prototype.advance=function(n){this.instance.advance(n)},o.prototype.initInputs=function(n){for(var a=0;a<this.instance.inputCount();a++){var d=this.instance.input(a);this.inputs.push(this.mapRuntimeInput(d,n))}},o.prototype.mapRuntimeInput=function(n,a){if(n.type===a.SMIInput.bool)return new me(oe.Boolean,n.asBool());if(n.type===a.SMIInput.number)return new me(oe.Number,n.asNumber());if(n.type===a.SMIInput.trigger)return new me(oe.Trigger,n.asTrigger())},o.prototype.cleanup=function(){this.instance.delete()},o}(),Be=function(){function o(n,a,d,v,g){v===void 0&&(v=[]),g===void 0&&(g=[]),this.runtime=n,this.artboard=a,this.eventManager=d,this.animations=v,this.stateMachines=g}return o.prototype.add=function(n,a,d){if(d===void 0&&(d=!0),n=ae(n),n.length===0)this.animations.forEach(function(U){return U.playing=a}),this.stateMachines.forEach(function(U){return U.playing=a});else for(var v=this.animations.map(function(U){return U.name}),g=this.stateMachines.map(function(U){return U.name}),w=0;w<n.length;w++){var A=v.indexOf(n[w]),M=g.indexOf(n[w]);if(A>=0||M>=0)A>=0?this.animations[A].playing=a:this.stateMachines[M].playing=a;else{var P=this.artboard.animationByName(n[w]);if(P){var x=new Ae(P,this.artboard,this.runtime,a);x.advance(0),x.apply(1),this.animations.push(x)}else{var Z=this.artboard.stateMachineByName(n[w]);if(Z){var ne=new fe(Z,this.runtime,a,this.artboard);this.stateMachines.push(ne)}}}}return d&&(a?this.eventManager.fire({type:W.Play,data:this.playing}):this.eventManager.fire({type:W.Pause,data:this.paused})),a?this.playing:this.paused},o.prototype.play=function(n){return this.add(n,!0)},o.prototype.pause=function(n){return this.add(n,!1)},o.prototype.scrub=function(n,a){var d=this.animations.filter(function(v){return n.includes(v.name)});return d.forEach(function(v){return v.scrubTo=a}),d.map(function(v){return v.name})},Object.defineProperty(o.prototype,"playing",{get:function(){return this.animations.filter(function(n){return n.playing}).map(function(n){return n.name}).concat(this.stateMachines.filter(function(n){return n.playing}).map(function(n){return n.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"paused",{get:function(){return this.animations.filter(function(n){return!n.playing}).map(function(n){return n.name}).concat(this.stateMachines.filter(function(n){return!n.playing}).map(function(n){return n.name}))},enumerable:!1,configurable:!0}),o.prototype.stop=function(n){var a=this;n=ae(n);var d=[];if(n.length===0)d=this.animations.map(function(w){return w.name}).concat(this.stateMachines.map(function(w){return w.name})),this.animations.forEach(function(w){return w.cleanup()}),this.stateMachines.forEach(function(w){return w.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var v=this.animations.filter(function(w){return n.includes(w.name)});v.forEach(function(w){w.cleanup(),a.animations.splice(a.animations.indexOf(w),1)});var g=this.stateMachines.filter(function(w){return n.includes(w.name)});g.forEach(function(w){w.cleanup(),a.stateMachines.splice(a.stateMachines.indexOf(w),1)}),d=v.map(function(w){return w.name}).concat(g.map(function(w){return w.name}))}return this.eventManager.fire({type:W.Stop,data:d}),d},Object.defineProperty(o.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(n,a){return n||a.playing},!1)||this.stateMachines.reduce(function(n,a){return n||a.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),o.prototype.atLeastOne=function(n,a){a===void 0&&(a=!0);var d;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([d=this.artboard.animationByIndex(0).name],n,a):this.artboard.stateMachineCount()>0&&this.add([d=this.artboard.stateMachineByIndex(0).name],n,a)),d},o.prototype.handleLooping=function(){for(var n=0,a=this.animations.filter(function(v){return v.playing});n<a.length;n++){var d=a[n];d.loopValue===0&&d.loopCount?(d.loopCount=0,this.stop(d.name)):d.loopValue===1&&d.loopCount?(this.eventManager.fire({type:W.Loop,data:{animation:d.name,type:be.Loop}}),d.loopCount=0):d.loopValue===2&&d.loopCount>1&&(this.eventManager.fire({type:W.Loop,data:{animation:d.name,type:be.PingPong}}),d.loopCount=0)}},o.prototype.handleStateChanges=function(){for(var n=[],a=0,d=this.stateMachines.filter(function(g){return g.playing});a<d.length;a++){var v=d[a];n.push.apply(n,v.statesChanged)}n.length>0&&this.eventManager.fire({type:W.StateChange,data:n})},o.prototype.handleAdvancing=function(n){this.eventManager.fire({type:W.Advance,data:n})},o}(),W;(function(o){o.Load="load",o.LoadError="loaderror",o.Play="play",o.Pause="pause",o.Stop="stop",o.Loop="loop",o.Draw="draw",o.Advance="advance",o.StateChange="statechange"})(W||(W={}));var be;(function(o){o.OneShot="oneshot",o.Loop="loop",o.PingPong="pingpong"})(be||(be={}));var Y=function(){function o(n){n===void 0&&(n=[]),this.listeners=n}return o.prototype.getListeners=function(n){return this.listeners.filter(function(a){return a.type===n})},o.prototype.add=function(n){this.listeners.includes(n)||this.listeners.push(n)},o.prototype.remove=function(n){for(var a=0;a<this.listeners.length;a++){var d=this.listeners[a];if(d.type===n.type&&d.callback===n.callback){this.listeners.splice(a,1);break}}},o.prototype.removeAll=function(n){var a=this;n?this.listeners.filter(function(d){return d.type===n}).forEach(function(d){return a.remove(d)}):this.listeners.splice(0,this.listeners.length)},o.prototype.fire=function(n){var a=this.getListeners(n.type);a.forEach(function(d){return d.callback(n)})},o}(),te=function(){function o(n){this.eventManager=n,this.queue=[]}return o.prototype.add=function(n){this.queue.push(n)},o.prototype.process=function(){for(;this.queue.length>0;){var n=this.queue.shift();n!=null&&n.action&&n.action(),n!=null&&n.event&&this.eventManager.fire(n.event)}},o}(),we=function(){function o(n){var a;this.loaded=!1,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.durations=[],this.frameTimes=[],this.frameCount=0,this.renderSecondTimer=0,this.canvas=n.canvas,this.src=n.src,this.buffer=n.buffer,this.layout=(a=n.layout)!==null&&a!==void 0?a:new c,this.shouldDisableRiveListeners=!!n.shouldDisableRiveListeners,this.eventManager=new Y,n.onLoad&&this.on(W.Load,n.onLoad),n.onLoadError&&this.on(W.LoadError,n.onLoadError),n.onPlay&&this.on(W.Play,n.onPlay),n.onPause&&this.on(W.Pause,n.onPause),n.onStop&&this.on(W.Stop,n.onStop),n.onLoop&&this.on(W.Loop,n.onLoop),n.onStateChange&&this.on(W.StateChange,n.onStateChange),n.onAdvance&&this.on(W.Advance,n.onAdvance),n.onload&&!n.onLoad&&this.on(W.Load,n.onload),n.onloaderror&&!n.onLoadError&&this.on(W.LoadError,n.onloaderror),n.onplay&&!n.onPlay&&this.on(W.Play,n.onplay),n.onpause&&!n.onPause&&this.on(W.Pause,n.onpause),n.onstop&&!n.onStop&&this.on(W.Stop,n.onstop),n.onloop&&!n.onLoop&&this.on(W.Loop,n.onloop),n.onstatechange&&!n.onStateChange&&this.on(W.StateChange,n.onstatechange),this.taskQueue=new te(this.eventManager),this.init({src:this.src,buffer:this.buffer,autoplay:n.autoplay,animations:n.animations,stateMachines:n.stateMachines,artboard:n.artboard,useOffscreenRenderer:n.useOffscreenRenderer})}return o.new=function(n){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new o(n)},o.prototype.init=function(n){var a=this,d=n.src,v=n.buffer,g=n.animations,w=n.stateMachines,A=n.artboard,M=n.autoplay,P=M===void 0?!1:M,x=n.useOffscreenRenderer,Z=x===void 0?!1:x;if(this.src=d,this.buffer=v,!this.src&&!this.buffer)throw new Error(o.missingErrorMessage);var ne=ae(g),U=ae(w);this.loaded=!1,this.readyForPlaying=!1,le.awaitInstance().then(function(se){a.runtime=se,a.renderer=a.runtime.makeRenderer(a.canvas,Z),a.canvas.width||a.canvas.height||a.resizeDrawingSurfaceToCanvas(),a.initData(A,ne,U,P).then(function(){return a.setupRiveListeners()}).catch(function(ye){console.error(ye)})}).catch(function(se){console.error(se)})},o.prototype.setupRiveListeners=function(){var n=this;if(!this.shouldDisableRiveListeners){var a=(this.animator.stateMachines||[]).filter(function(d){return d.playing&&n.runtime.hasListeners(d.instance)}).map(function(d){return d.instance});this.eventCleanup=(0,V.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:a,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime)})}},o.prototype.initData=function(n,a,d,v){var g;return ve(this,void 0,void 0,function(){var w,A,M;return Ue(this,function(P){switch(P.label){case 0:return this.src?(w=this,[4,xe(this.src)]):[3,2];case 1:w.buffer=P.sent(),P.label=2;case 2:return A=this,[4,this.runtime.load(new Uint8Array(this.buffer))];case 3:return A.file=P.sent(),this.file?(this.initArtboard(n,a,d,v),this.loaded=!0,this.eventManager.fire({type:W.Load,data:(g=this.src)!==null&&g!==void 0?g:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,Promise.resolve()]):(M="Problem loading file; may be corrupt!",console.warn(M),this.eventManager.fire({type:W.LoadError,data:M}),[2,Promise.reject(M)])}})})},o.prototype.initArtboard=function(n,a,d,v){var g=n?this.file.artboardByName(n):this.file.defaultArtboard();if(!g){var w="Invalid artboard name or no default artboard";console.warn(w),this.eventManager.fire({type:W.LoadError,data:w});return}if(this.artboard=g,this.artboard.animationCount()<1){var w="Artboard has no animations";throw this.eventManager.fire({type:W.LoadError,data:w}),w}this.animator=new Be(this.runtime,this.artboard,this.eventManager);var A;a.length>0||d.length>0?(A=a.concat(d),this.animator.add(A,v,!1)):A=[this.animator.atLeastOne(v,!1)],this.taskQueue.add({event:{type:v?W.Play:W.Pause,data:A}})},o.prototype.drawFrame=function(){this.startRendering()},o.prototype.draw=function(n,a){var d=performance.now();this.frameRequestId=null,this.lastRenderTime||(this.lastRenderTime=n),this.renderSecondTimer+=n-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,a==null||a());var v=(n-this.lastRenderTime)/1e3;this.lastRenderTime=n;for(var g=this.animator.animations.filter(function(ye){return ye.playing||ye.needsScrub}).sort(function(ye){return ye.needsScrub?-1:1}),w=0,A=g;w<A.length;w++){var M=A[w];M.advance(v),M.instance.didLoop&&(M.loopCount+=1),M.apply(1)}for(var P=this.animator.stateMachines.filter(function(ye){return ye.playing}),x=0,Z=P;x<Z.length;x++){var ne=Z[x];ne.advance(v)}this.artboard.advance(v);var U=this.renderer;U.clear(),U.save(),this.alignRenderer(),this.artboard.draw(U),U.restore(),U.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(v),this.frameCount++;var se=performance.now();for(this.frameTimes.push(se),this.durations.push(se-d);this.frameTimes[0]<=se-1e3;)this.frameTimes.shift(),this.durations.shift();this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},o.prototype.alignRenderer=function(){var n=this,a=n.renderer,d=n.runtime,v=n._layout,g=n.artboard;a.align(v.runtimeFit(d),v.runtimeAlignment(d),{minX:v.minX,minY:v.minY,maxX:v.maxX,maxY:v.maxY},g.bounds)},Object.defineProperty(o.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(n,a){return n+a},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),o.prototype.cleanup=function(){var n,a;this.stopRendering(),this.cleanupInstances(),(n=this.renderer)===null||n===void 0||n.delete(),this.renderer=null,(a=this.file)===null||a===void 0||a.delete(),this.file=null},o.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},o.prototype.play=function(n,a){var d=this;if(n=ae(n),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.play(n,a)}});return}this.animator.play(n),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},o.prototype.pause=function(n){var a=this;if(n=ae(n),!this.readyForPlaying){this.taskQueue.add({action:function(){return a.pause(n)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(n)},o.prototype.scrub=function(n,a){var d=this;if(n=ae(n),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.scrub(n,a)}});return}this.animator.scrub(n,a||0),this.drawFrame()},o.prototype.stop=function(n){var a=this;if(n=ae(n),!this.readyForPlaying){this.taskQueue.add({action:function(){return a.stop(n)}});return}this.animator.stop(n),this.eventCleanup&&this.eventCleanup()},o.prototype.reset=function(n){var a,d=n==null?void 0:n.artboard,v=ae(n==null?void 0:n.animations),g=ae(n==null?void 0:n.stateMachines),w=(a=n==null?void 0:n.autoplay)!==null&&a!==void 0?a:!1;this.cleanupInstances(),this.initArtboard(d,v,g,w),this.taskQueue.process()},o.prototype.load=function(n){this.stop(),this.init(n)},Object.defineProperty(o.prototype,"layout",{get:function(){return this._layout},set:function(n){this._layout=n,(!n.maxX||!n.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),o.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},o.prototype.resizeDrawingSurfaceToCanvas=function(){if(this.canvas instanceof HTMLCanvasElement&&!!window){var n=this.canvas.getBoundingClientRect(),a=n.width,d=n.height,v=window.devicePixelRatio||1;this.canvas.width=v*a,this.canvas.height=v*d,this.startRendering(),this.resizeToCanvas()}},Object.defineProperty(o.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"animationNames",{get:function(){if(!this.loaded)return[];for(var n=[],a=0;a<this.artboard.animationCount();a++)n.push(this.artboard.animationByIndex(a).name);return n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stateMachineNames",{get:function(){if(!this.loaded)return[];for(var n=[],a=0;a<this.artboard.stateMachineCount();a++)n.push(this.artboard.stateMachineByIndex(a).name);return n},enumerable:!1,configurable:!0}),o.prototype.stateMachineInputs=function(n){if(!!this.loaded){var a=this.animator.stateMachines.find(function(d){return d.name===n});return a==null?void 0:a.inputs}},Object.defineProperty(o.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(n){return n.playing}).map(function(n){return n.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(n){return n.playing}).map(function(n){return n.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(n){return!n.playing}).map(function(n){return n.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(n){return!n.playing}).map(function(n){return n.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),o.prototype.on=function(n,a){this.eventManager.add({type:n,callback:a})},o.prototype.off=function(n,a){this.eventManager.remove({type:n,callback:a})},o.prototype.unsubscribe=function(n,a){console.warn("This function is deprecated: please use `off()` instead."),this.off(n,a)},o.prototype.removeAllRiveEventListeners=function(n){this.eventManager.removeAll(n)},o.prototype.unsubscribeAll=function(n){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(n)},o.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},o.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this.draw.bind(this)):this.frameRequestId=requestAnimationFrame(this.draw.bind(this)))},o.prototype.enableFPSCounter=function(n){this.runtime.enableFPSCounter(n)},o.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(o.prototype,"contents",{get:function(){if(!!this.loaded){for(var n={artboards:[]},a=0;a<this.file.artboardCount();a++){for(var d=this.file.artboardByIndex(a),v={name:d.name,animations:[],stateMachines:[]},g=0;g<d.animationCount();g++){var w=d.animationByIndex(g);v.animations.push(w.name)}for(var A=0;A<d.stateMachineCount();A++){for(var M=d.stateMachineByIndex(A),P=M.name,x=new this.runtime.StateMachineInstance(M,d),Z=[],ne=0;ne<x.inputCount();ne++){var U=x.input(ne);Z.push({name:U.name,type:U.type})}v.stateMachines.push({name:P,inputs:Z})}n.artboards.push(v)}return n}},enumerable:!1,configurable:!0}),o.missingErrorMessage="Rive source file or data buffer required",o}(),xe=function(o){return ve(void 0,void 0,void 0,function(){var n,a,d;return Ue(this,function(v){switch(v.label){case 0:return n=new Request(o),[4,fetch(n)];case 1:return a=v.sent(),[4,a.arrayBuffer()];case 2:return d=v.sent(),[2,d]}})})},ae=function(o){return typeof o=="string"?[o]:o instanceof Array?o:[]},ge={EventManager:Y,TaskQueueManager:te}})(),Oe})())})(on);var Xn=class extends On{applyAvatarBlendShapeValues(N){}resetAvatarEmotion(){}async loadAvatar(N){var pe,We,Pe;if(this.canvas){if(!this.rive){this.rive=new on.exports.Rive({src:N.fileUrl,canvas:this.canvas,autoplay:!0,onLoad:()=>{var B,z,V,ve;(B=N.callback)==null||B.call(N,"loaded"),(z=this.rive)==null||z.resizeDrawingSurfaceToCanvas(),(ve=this.rive)==null||ve.play((V=this.rive)==null?void 0:V.stateMachineNames[0])}});let K=()=>{var B;(B=this.canvas)!=null&&B.parentElement&&this.rive.resizeDrawingSurfaceToCanvas()},Oe;window.addEventListener("resize",()=>{clearTimeout(Oe),Oe=setTimeout(K,100)}),K()}(pe=N.callback)==null||pe.call(N,"starting"),(We=N.callback)==null||We.call(N,"loading"),(Pe=this.rive)==null||Pe.load({src:N.fileUrl,autoplay:!0})}}async init(N){this.canvas=N}destroy(){var N;(N=this.rive)==null||N.cleanup(),this.rive=void 0,this.canvas=void 0}getCurrentStateMachineInput(N){var pe,We,Pe,K;return(K=(Pe=this.rive)==null?void 0:Pe.stateMachineInputs((We=(pe=this.rive)==null?void 0:pe.stateMachineNames[0])!=null?We:""))==null?void 0:K.find(Oe=>Oe.name===N)}setAvatarPosition(N,pe){}setAvatarScale(N){}setAvatarRotation(N){}setAvatarEmotion(N){let pe=this.getCurrentStateMachineInput("emotion");pe||console.error(`Emotion not found on rive file, please make sure you have an trigger called  "${N}"`),pe==null||pe.fire()}getAvatarAllEmotion(){return[]}getAvatarAllParameters(){return[]}getModelFiles(){return[]}};export{Xn as RiveAvatarService};
